<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no">
    <title>MSFXP 服务器</title>
    <link rel="icon" href="./images/Logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2196F3;
            --secondary-color: #03A9F4;
            --accent-color: #00BCD4;
            --dark-color: #333;
            --light-color: #f9f9f9;
            --gradient-bg: linear-gradient(135deg, #0c2646 0%, #204065 50%, #2a5788 100%);
            --primary-color-rgb: 33, 150, 243;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            min-height: 100vh;
            margin: 0;
            background: var(--gradient-bg);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            font-family: 'Arial', sans-serif;
            color: #fff;
            overflow-x: hidden;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.03);
            pointer-events: none;
        }
        
        .header {
            width: 100%;
            padding: 20px 0;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .header-right {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .user-center-btn {
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        .user-center-btn i {
            margin-right: 5px;
        }
        
        .user-center-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            font-size: 2.5rem;
            margin: 0;
            background: linear-gradient(to right, var(--accent-color), var(--primary-color));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .container {
            width: 90%;
            max-width: 800px;
            background: rgba(255, 255, 255, 0.03);
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 15px;
            margin: 40px 0;
            border: 1px solid rgba(255, 255, 255, 0.15);
            position: relative;
            z-index: 1;
            overflow: hidden;
        }
        
        /* 为不支持backdrop-filter的浏览器提供备选样式 */
        @supports not (backdrop-filter: blur(10px)) {
            .container {
                background: rgba(12, 38, 70, 0.7);
            }
        }
        
        .container::before {
            display: none;
        }
        
        h2 {
            color: var(--accent-color);
            margin-bottom: 15px;
            position: relative;
            padding-bottom: 10px;
        }
        
        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background: var(--primary-color);
            border-radius: 3px;
        }
        
        p {
            line-height: 1.6;
            margin-bottom: 20px;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .server-status {
            margin: 10px 0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.05);
            display: flex;
            justify-content: flex-start;
            position: relative;
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            flex-direction: column;
            flex: 1;
            height: auto;
            min-height: 200px;
            max-height: 500px;
        }
        
        .server-status::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(to right, var(--primary-color), var(--accent-color));
            z-index: 1;
        }
        
        .status-card .motd-container {
            min-height: unset;
            height: auto;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            gap: 10px;
        }
        
        .status-card h2 {
            margin-bottom: 10px;
        }
        
        .motd-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .motd-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin: 0;
            color: var(--accent-color);
        }
        
        .motd-address {
            font-size: 1rem;
            margin: 3px 0 10px 0;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .motd-version {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 10px;
        }
        
        .motd-button {
            background: linear-gradient(to right, var(--primary-color), var(--accent-color));
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 5px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }
        
        .motd-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .server-selectors {
            display: flex;
            gap: 8px;
            margin: 8px 0;
            flex-wrap: wrap;
        }
        
        .motd-info-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }
        
        .motd-info-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            transition: background 0.3s ease;
        }
        
        .motd-info-item:hover {
            background: rgba(255, 255, 255, 0.15);
        }
        
        .motd-info-item i {
            margin-right: 15px;
            color: var(--accent-color);
            width: 20px;
            text-align: center;
        }
        
        .motd-container {
            width: 100%;
            max-width: 100%;
            min-height: auto;
            border: none;
            display: flex;
            flex-direction: column;
            color: white;
        }
        
        .motd-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 200px;
        }
        
        .motd-loading i {
            font-size: 2rem;
            color: var(--accent-color);
            margin-bottom: 15px;
        }
        
        .motd-error {
            color: #ff5252;
            text-align: center;
            margin-top: 10px;
        }
        
        .motd-status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        .motd-online {
            background-color: #4CAF50;
        }
        
        .motd-offline {
            background-color: #ff5252;
        }
        
        .action-button {
            background: linear-gradient(to right, var(--primary-color), var(--accent-color));
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.2rem;
            margin-top: 30px;
            display: inline-block;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .action-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        .action-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }
        
        .action-button:hover::before {
            left: 100%;
        }
        
        .action-button i {
            margin-right: 10px;
        }
        
        .footer {
            width: 100%;
            background-color: rgba(0, 0, 0, 0.3);
            color: rgba(255, 255, 255, 0.7);
            text-align: center;
            padding: 20px 0;
            margin-top: auto;
            backdrop-filter: blur(10px);
        }
        
        .footer a {
            color: var(--accent-color);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer a:hover {
            color: var(--primary-color);
            text-decoration: underline;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .container {
                width: 95%;
                padding: 20px;
            }
            
            .action-button {
                width: 100%;
                font-size: 1rem;
            }
            
            /* 手机访问时标题左对齐 */
            .header {
                justify-content: flex-start;
                padding-left: 20px;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 1.8rem;
            }
            
            h2 {
                font-size: 1.3rem;
            }
            
            .server-status iframe {
                height: 240px;
            }
        }
        
        .server-selectors {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        
        .server-selector {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }
        
        .server-selector:hover, .server-selector.active {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .server-selector.active {
            border-color: var(--accent-color);
        }
        
        /* 服务器选择对话框样式 */
        .server-select-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .server-select-content {
            background-color: rgba(20, 50, 80, 0.95);
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }
        
        .server-select-header {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .server-select-header h3 {
            margin: 0;
            color: white;
        }
        
        .close-dialog {
            color: white;
            font-size: 24px;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .close-dialog:hover {
            color: var(--accent-color);
        }
        
        .server-select-body {
            padding: 20px;
            color: white;
        }
        
        .server-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 15px;
        }
        
        .server-option {
            padding: 15px;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .server-option:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .server-option.recommended {
            background-color: rgba(var(--primary-color-rgb), 0.15);
            border-color: rgba(var(--primary-color-rgb), 0.3);
        }
        
        .server-option-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .server-option-address {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9em;
        }
        
        .server-option-delay {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.85em;
            margin-top: 3px;
        }
        
        .recommended-badge {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            position: absolute;
            top: -10px;
            right: -10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 1;
        }
        
        .server-option.offline {
            opacity: 0.7;
            border-color: rgba(255, 77, 77, 0.3);
        }
        
        .server-option-status {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8em;
            margin-top: 5px;
        }
        
        .server-option-status.online {
            background-color: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }
        
        .server-option-status.offline {
            background-color: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }
        
        /* 快速操作按钮样式 */
        .quick-actions {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .quick-action-button {
            padding: 12px 20px;
            border-radius: 50px;
            text-decoration: none;
            color: white;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 200px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .quick-action-button i {
            margin-right: 10px;
            font-size: 1.2em;
        }
        
        .quick-action-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
        }
        
        .download-btn {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }
        
        .qq-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        @media (max-width: 480px) {
            .quick-actions {
                flex-direction: column;
            }
            
            .quick-action-button {
                width: 100%;
            }
        }
        
        /* 版本选择对话框 */
        .download-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            overflow: hidden;
        }
        
        .download-dialog-content {
            background-color: rgba(20, 50, 80, 0.95);
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .download-dialog-header {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            flex-shrink: 0;
        }
        
        .download-dialog-header h3 {
            margin: 0;
            color: white;
        }
        
        .download-dialog-body {
            padding: 20px;
            color: white;
            overflow-y: auto;
            flex-grow: 1;
            max-height: calc(90vh - 60px); /* 减去header的高度 */
            -webkit-overflow-scrolling: touch; /* 提高移动设备上的滚动体验 */
        }
        
        .download-options {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .download-intro {
            text-align: center;
            margin-bottom: 20px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.1em;
        }
        
        .download-links-section {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .platform-selector {
            display: flex;
            justify-content: center;
            border-radius: 8px;
            overflow: hidden;
            background-color: rgba(0, 0, 0, 0.2);
            margin-bottom: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        .platform-btn {
            background: none;
            border: none;
            color: white;
            padding: 12px 20px;
            cursor: pointer;
            flex: 1;
            transition: all 0.3s ease;
            font-size: 0.95em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            border-right: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .platform-btn:last-child {
            border-right: none;
        }
        
        .platform-btn i {
            font-size: 1.2em;
        }
        
        .platform-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .platform-btn.active {
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            font-weight: 500;
        }
        
        .download-platform-info {
            margin-bottom: 20px;
        }
        
        .platform-info-card {
            display: none;
            background-color: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeIn 0.3s ease;
            position: relative;
        }
        
        .platform-info-card.active {
            display: block;
        }
        
        .platform-title {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            gap: 15px;
        }
        
        .platform-icon-large {
            font-size: 35px;
            color: var(--accent-color);
            background: rgba(255, 255, 255, 0.1);
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
        }
        
        .platform-name {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 5px;
        }
        
        .platform-version {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9em;
        }
        
        .platform-desc {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.5;
            font-size: 0.95em;
        }
        
        .download-links-container {
            background-color: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .section-title {
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--accent-color);
            text-align: center;
            font-size: 1.1em;
        }
        
        .download-links {
            display: none;
            flex-direction: column;
            gap: 10px;
        }
        
        .download-links.active {
            display: flex;
        }
        
        .download-link {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            text-decoration: none;
            padding: 12px 20px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .download-link:hover {
            background-color: rgba(var(--primary-color-rgb), 0.3);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border-color: rgba(var(--primary-color-rgb), 0.3);
        }
        
        .download-icon {
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            color: white;
            font-size: 0.9em;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @media (max-width: 480px) {
            .platform-title {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }
            
            .recommended-badge {
                margin: 0;
                top: -10px;
                right: -5px;
            }
            
            .platform-btn {
                padding: 10px;
                font-size: 0.9em;
            }
            
            .platform-btn i {
                margin-right: 0;
            }
            
            .platform-btn span {
                display: none;
            }
        }
        
        .server-gallery {
            margin-top: 30px;
            margin-bottom: 30px;
        }
        
        .server-gallery h3 {
            color: var(--accent-color);
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 10px;
            text-align: left;
        }
        
        .server-gallery h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background: var(--primary-color);
            border-radius: 3px;
        }
        
        .gallery-container {
            position: relative;
            width: 100%;
            height: 300px;
            overflow: hidden;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .gallery-slides {
            display: flex;
            width: 100%;
            height: 100%;
            transition: transform 0.5s ease;
        }
        
        .gallery-item {
            min-width: 100%;
            height: 100%;
            position: relative;
        }
        
        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .gallery-controls {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            z-index: 2;
        }
        
        .gallery-nav {
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }
        
        .gallery-nav:hover {
            background-color: rgba(var(--primary-color-rgb), 0.7);
            transform: scale(1.1);
        }
        
        .gallery-dots {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 2;
        }
        
        .gallery-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .gallery-dot.active {
            background-color: white;
            transform: scale(1.2);
        }
        
        @media (max-width: 768px) {
            .gallery-container {
                height: 220px;
            }
        }

        /* 移动设备横屏时 */
        @media (max-width: 768px) and (orientation: landscape) {
            .gallery-container {
                height: 180px;
            }
        }
        
        /* 灯箱效果 */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            flex-direction: column;
        }
        
        .close-lightbox {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 40px;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1001;
        }
        
        .close-lightbox:hover {
            color: var(--accent-color);
        }
        
        .lightbox-content {
            max-width: 90%;
            max-height: 80%;
            object-fit: contain;
            border-radius: 5px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.7);
            transition: transform 0.3s ease;
        }
        
        .lightbox-controls {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        .lightbox-nav {
            background-color: rgba(0, 0, 0, 0.5);
            border: none;
            color: white;
            cursor: pointer;
            font-size: 20px;
            height: 60px;
            width: 60px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
            z-index: 1001;
        }
        
        .lightbox-nav:hover {
            background-color: rgba(var(--primary-color-rgb), 0.7);
            transform: scale(1.1);
        }
        
        .lightbox-prev {
            margin-right: auto;
        }
        
        .lightbox-next {
            margin-left: auto;
        }
        
        @media (max-width: 768px) {
            .lightbox-nav {
                height: 40px;
                width: 40px;
                font-size: 16px;
            }
        }
        
        /* 新的卡片布局样式 */
        .cards-container {
            width: 90%;
            max-width: 1200px;
            margin: 40px auto;
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: center;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.03);
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            position: relative;
            z-index: 1;
            overflow: hidden;
            flex: 1 1 400px;
            min-width: 0;
        }
        
        /* 为不支持backdrop-filter的浏览器提供备选样式 */
        @supports not (backdrop-filter: blur(10px)) {
            .card {
                background: rgba(12, 38, 70, 0.7);
            }
        }
        
        .intro-card {
            flex: 1 1 500px;
        }
        
        .status-card {
            flex: 1 1 350px;
            display: flex;
            flex-direction: column;
        }
        
        .motd-info-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }
        
        .motd-info-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            transition: background 0.3s ease;
        }
        
        @media (max-width: 900px) {
            .cards-container {
                flex-direction: column;
            }
            
            .card {
                flex: 1 1 auto;
                width: 100%;
            }
            
            .status-card {
                margin-top: 0;
            }
            
            .server-status {
                height: auto;
                min-height: 200px;
            }
        }
        
        .mac-notice {
            background-color: rgba(13, 36, 54, 0.7);
            border: 1px solid #ffb700;
            color: #ffb700;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .mac-notice i {
            font-size: 1.5em;
            color: #ffb700;
            flex-shrink: 0;
            background: rgba(255, 183, 0, 0.2);
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .mac-notice .tool-link {
            color: #a287e0;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.2s ease;
            display: inline-block;
            padding: 0 5px;
        }
        
        .mac-notice .tool-link:hover {
            color: #b39ddb;
            text-decoration: underline;
        }
        
        /* 防止下载对话框滚动影响背景 */
        body.dialog-open {
            overflow: hidden;
        }
        
        .platform-desc .mac-install-tip {
            background-color: rgba(52, 152, 219, 0.1);
            border-left: 3px solid #3498db;
            padding: 12px 15px;
            margin-top: 15px;
            border-radius: 0 8px 8px 0;
            font-size: 0.95em;
            line-height: 1.6;
        }
        
        .platform-desc .mac-install-tip i {
            color: #3498db;
            margin-right: 8px;
        }
        
        .platform-desc .mac-install-tip strong {
            color: #fff;
            display: block;
            margin-bottom: 8px;
        }
        
        .platform-desc .mac-install-tip .steps {
            margin-top: 10px;
            padding-left: 20px;
        }
        
        .platform-desc .mac-install-tip .step {
            margin-bottom: 5px;
        }
        
        .platform-desc .mac-install-tip .tool-link {
            color: #a287e0;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.2s ease;
            display: inline-block;
            padding: 0 2px;
        }
        
        .platform-desc .mac-install-tip .tool-link:hover {
            color: #b39ddb;
            text-decoration: underline;
        }

    </style>
</head>
<body>
    <div class="header">
        <h1>MSFXP 服务器</h1>
        <div class="header-right">
            <button class="user-center-btn" onclick="connectToServer()">
                <i class="fas fa-user-circle"></i>个人中心
            </button>
        </div>
    </div>
    
    <div class="cards-container">
        <div class="card intro-card">
            <h2>嘿！这里是MSFXP</h2>
            <p>
                在这里，你将进入一个充满挑战与创意的生存世界！<br>
                我们拥有丰富多样的玩法，包括：<br>
                 • 怪物强化，战斗更刺激！<br>
                 • 装备强化，打造独一无二的神装！<br>
                 • 枪械系统，远程火力碾压敌人！<br>
                 • 妖精女仆，可爱又实用的贴身帮手！<br>
                 • 更有"生电大佬"（划掉）带你玩转科技！<br>
                无论你是建筑党、生电党、还是战斗党，这里都能找到属于你的乐趣！<br>
                快来和一群志同道合的小伙伴一起开启全新的冒险吧！
            </p>
            
            <div class="server-gallery">
                <h3>服务器风光</h3>
                <div class="gallery-container">
                    <div class="gallery-slides" id="gallerySlides">
                        <div class="gallery-item" data-index="0">
                            <img src="./images/server/1.png" alt="服务器场景1">
                        </div>
                        <div class="gallery-item" data-index="1">
                            <img src="./images/server/2.png" alt="服务器场景2">
                        </div>
                        <div class="gallery-item" data-index="2">
                            <img src="./images/server/3.png" alt="服务器场景3">
                        </div>
                        <div class="gallery-item" data-index="3">
                            <img src="./images/server/4.png" alt="服务器场景4">
                        </div>
                        <div class="gallery-item" data-index="4">
                            <img src="./images/server/5.png" alt="服务器场景5">
                        </div>
                        <div class="gallery-item" data-index="5">
                            <img src="./images/server/6.png" alt="服务器场景6">
                        </div>
                    </div>
                    <div class="gallery-controls">
                        <button class="gallery-nav gallery-prev" onclick="slideGallery(-1)">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="gallery-nav gallery-next" onclick="slideGallery(1)">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="gallery-dots" id="galleryDots">
                        <!-- 轮播图指示点将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>
            
        </div>
        
        <div class="card status-card">
            <h2>服务器状态</h2>
            <div class="server-status">
                <div id="motdContainer" class="motd-container">
                    <div class="motd-loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <div>正在连接服务器...</div>
                    </div>
                </div>
            </div>
            <div class="quick-actions">
                <a href="javascript:void(0);" onclick="showDownloadOptions()" class="quick-action-button download-btn">
                    <i class="fas fa-download"></i>Minecraft下载
                </a>
                <a href="https://qq.msfxp.top" class="quick-action-button qq-btn">
                    <i class="fas fa-users"></i>QQ交流群
                </a>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <div style="margin-top: 5px; font-size: 0.8rem;">Copyright © 2019-2025 MSFXP | Made By UCKET & yuexps</div>
    </div>

    <!-- 灯箱效果 -->
    <div id="lightbox" class="lightbox">
        <span class="close-lightbox" onclick="closeLightbox()">&times;</span>
        <img id="lightbox-img" class="lightbox-content">
        <div class="lightbox-controls">
            <button onclick="changeImage(-1)" class="lightbox-nav lightbox-prev"><i class="fas fa-chevron-left"></i></button>
            <button onclick="changeImage(1)" class="lightbox-nav lightbox-next"><i class="fas fa-chevron-right"></i></button>
        </div>
    </div>

    <script src="activity.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const servers = [
                {
                    name: "主要IP",
                    ip: "msfxp.ucket.my",
                    port: "19125",
                    delay: 999,
                    status: "unknown"
                },
                {
                    name: "备用IP",
                    ip: "survival.msfxp.top",
                    port: "23236",
                    delay: 999,
                    status: "unknown"
                }
            ];
            
            // 初始化轮播图
            initGallery();
            
            // 使服务器数据全局可访问
            window.servers = servers;
            
            // 检测Mac设备，设置全局变量
            window.isMacDevice = detectDevice().mac;
            
            let currentServerIndex = 0;
            
            const motdContainer = document.getElementById('motdContainer');
            
            motdContainer.innerHTML = `
                <div class="motd-loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <div>正在连接服务器...</div>
                </div>
            `;
            
            // 同时获取所有服务器的状态
            fetchAllServersStatus();
            
            // 设置定时刷新
            setInterval(fetchAllServersStatus, 60000);
            
            // 同时获取所有服务器的状态
            function fetchAllServersStatus() {
                // 重置服务器状态
                servers.forEach(server => {
                    server.status = "unknown";
                });
                
                // 获取全部服务器的状态
                const fetchPromises = servers.map((server, index) => {
                    const serverAddress = `${server.ip}:${server.port}`;
                    const apiUrl = `https://motdbe.blackbe.work/api?host=${serverAddress}`;
                    
                    return fetch(apiUrl)
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('网络响应错误');
                            }
                            return response.json();
                        })
                        .then(data => {
                            servers[index].delay = data.delay || 999;
                            servers[index].status = "online";
                            servers[index].data = data;
                            return data;
                        })
                        .catch(error => {
                            console.error(`获取服务器 ${serverAddress} 状态失败:`, error);
                            servers[index].delay = 999;
                            servers[index].status = "offline";
                            return null;
                        });
                });
                
                // 等待所有请求完成
                Promise.all(fetchPromises).then(() => {
                    // 查找延迟最低的在线服务器
                    let lowestDelayIndex = -1;
                    let lowestDelay = 999999;
                    
                    for (let i = 0; i < servers.length; i++) {
                        if (servers[i].status === "online" && servers[i].delay < lowestDelay) {
                            lowestDelay = servers[i].delay;
                            lowestDelayIndex = i;
                        }
                    }
                    
                    // 如果找到在线服务器，显示延迟最低的
                    if (lowestDelayIndex >= 0) {
                        currentServerIndex = lowestDelayIndex;
                        updateMotdDisplay(servers[lowestDelayIndex].data, servers[lowestDelayIndex], servers);
                    } else {
                        // 如果所有服务器都离线，显示离线状态
                        displayOfflineStatus(servers[0]);
                    }
                });
            }
            
            window.switchServer = function(index) {
                if (index >= 0 && index < servers.length) {
                    currentServerIndex = index;
                    
                    if (servers[index].status === "online" && servers[index].data) {
                        // 如果已经有数据，直接显示
                        updateMotdDisplay(servers[index].data, servers[index], servers);
                    } else if (servers[index].status === "offline") {
                        // 如果已知离线，显示离线状态
                        displayOfflineStatus(servers[index]);
                    } else {
                        // 如果状态未知，重新获取
                        const serverAddress = `${servers[index].ip}:${servers[index].port}`;
                        const apiUrl = `https://motdbe.blackbe.work/api?host=${serverAddress}`;
                        
                        // 显示加载状态
                        motdContainer.innerHTML = `
                            <div class="motd-loading">
                                <i class="fas fa-spinner fa-spin"></i>
                                <div>正在连接服务器...</div>
                            </div>
                        `;
                        
                        fetch(apiUrl)
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error('网络响应错误');
                                }
                                return response.json();
                            })
                            .then(data => {
                                servers[index].delay = data.delay || 999;
                                servers[index].status = "online";
                                servers[index].data = data;
                                updateMotdDisplay(data, servers[index], servers);
                            })
                            .catch(error => {
                                console.error(`获取服务器 ${serverAddress} 状态失败:`, error);
                                servers[index].delay = 999;
                                servers[index].status = "offline";
                                displayOfflineStatus(servers[index]);
                            });
                    }
                }
            };
        });
        
        function updateMotdDisplay(data, currentServer, allServers) {
            const motdContainer = document.getElementById('motdContainer');
            
            if (!data || data.status !== "online") {
                displayOfflineStatus(currentServer);
                return;
            }
            
            let cleanMotd = data.motd || "MSFXP Survival";
            cleanMotd = cleanMotd.replace(/§[0-9a-fklmnor]/gi, '');
            
            let serverSelectorsHtml = '';
            allServers.forEach((server, index) => {
                if (server.isIpv6) return;
                
                const isActive = server.ip === currentServer.ip && server.port === currentServer.port;
                const statusClass = server.status === "online" ? "online" : (server.status === "offline" ? "offline" : "");
                serverSelectorsHtml += `
                    <button class="server-selector ${isActive ? 'active' : ''} ${statusClass}" 
                            onclick="switchServer(${index})" 
                            data-server-info='{"index": ${index}, "delay": ${server.delay || 999}, "status": "${server.status}"}'>
                        ${server.name}
                    </button>
                `;
            });
            
            motdContainer.innerHTML = `
                <div class="motd-header">
                    <h2 class="motd-title"><span class="motd-status-indicator motd-online"></span>${cleanMotd}</h2>
                </div>
                
                <div class="server-selectors">
                    ${serverSelectorsHtml}
                </div>
                
                <div class="motd-address">${data.host}</div>
                <div class="motd-version">MCBE: ${data.version || "1.20.15"} | Protocol: ${data.agreement || "未知"}</div>
                
                <button class="motd-button" onclick="joinServer(${allServers.indexOf(currentServer)})">加入服务器</button>
                
                <div class="motd-info-grid">
                    <div class="motd-info-item">
                        <i class="fas fa-gamepad"></i>
                        <span>游戏模式: ${data.gamemode || "Survival"}</span>
                    </div>
                    <div class="motd-info-item">
                        <i class="fas fa-users"></i>
                        <span>在线人数: ${data.online} / ${data.max}</span>
                    </div>
                    <div class="motd-info-item">
                        <i class="fas fa-map"></i>
                        <span>地图名: ${data.level_name || cleanMotd}</span>
                    </div>
                    <div class="motd-info-item">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>延迟: ${data.delay || "-"} ms</span>
                    </div>
                </div>
            `;
        }
        
        function joinServer(serverIndex = 0) {
            // 使用页面上已加载的服务器数据
            const mainServers = document.querySelectorAll('[data-server-info]');
            const servers = [
                {
                    name: "主要IP",
                    server_name: "§b§lMSFXP",
                    ip: "msfxp.ucket.my",
                    port: "19125",
                    delay: 999
                },
                {
                    name: "备用IP",
                    server_name: "§b§lMSFXP",
                    ip: "survival.msfxp.top",
                    port: "23236",
                    delay: 999
                }
            ];
            
            // 同步全局服务器状态中的延迟数据
            try {
                const parentScope = window.parent || window;
                if (parentScope.document) {
                    if (typeof parentScope.servers !== 'undefined') {
                        // 可以从上面的全局变量中获取服务器数据
                        for (let i = 0; i < Math.min(2, parentScope.servers.length); i++) {
                            if (parentScope.servers[i].status === 'online') {
                                servers[i].delay = parentScope.servers[i].delay || 999;
                                servers[i].status = 'online';
                            } else {
                                servers[i].delay = 999;
                                servers[i].status = 'offline';
                            }
                        }
                    }
                }
            } catch (e) {
                console.error('获取服务器数据失败', e);
                
                // 备用方法：从DOM中获取主页面已经存在的服务器延迟数据
                try {
                    const delayElements = document.querySelectorAll('.motd-info-item .fa-tachometer-alt');
                    if (delayElements.length > 0) {
                        const delayText = delayElements[0].nextElementSibling.textContent;
                        const delayMatch = delayText.match(/(\d+)/);
                        if (delayMatch && delayMatch[1]) {
                            const currentDelay = parseInt(delayMatch[1]);
                            // 更新当前显示服务器的延迟
                            servers[serverIndex].delay = currentDelay;
                            servers[serverIndex].status = 'online';
                        }
                    }
                } catch (e) {
                    console.error('获取延迟数据失败', e);
                }
            }
            
            // 查找延迟最低的非IPv6服务器
            let lowestDelayIndex = 0;
            let lowestDelay = 999999;
            
            for (let i = 0; i < 2; i++) { // 只考虑前2个非IPv6服务器
                if (servers[i].status !== 'offline' && servers[i].delay < lowestDelay) {
                    lowestDelay = servers[i].delay;
                    lowestDelayIndex = i;
                }
            }
            
            // 如果所有服务器都离线，使用当前显示的服务器
            if (lowestDelay === 999999) {
                lowestDelayIndex = serverIndex;
            }
            
            let dialogHTML = `
                <div id="serverSelectDialog" class="server-select-dialog">
                    <div class="server-select-content">
                        <div class="server-select-header">
                            <h3>选择服务器IP</h3>
                            <span class="close-dialog" onclick="closeServerDialog()">&times;</span>
                        </div>
                        <div class="server-select-body">
                            <p>请选择要加入的服务器IP：</p>
                            <div class="server-options">`;
            
            servers.forEach((server, idx) => {
                const isRecommended = idx === lowestDelayIndex && !server.isIpv6;
                const delayInfo = server.delay < 999 ? `<div class="server-option-delay">延迟: ${server.delay} ms</div>` : '';
                const statusBadge = server.status === 'offline' ? 
                    '<div class="server-option-status offline">离线</div>' : 
                    (server.delay < 999 ? '<div class="server-option-status online">在线</div>' : '');
                
                dialogHTML += `
                    <div class="server-option ${isRecommended ? 'recommended' : ''} ${server.status === 'offline' ? 'offline' : ''}" 
                         onclick="connectToMinecraft('${server.server_name}', '${server.ip}', '${server.port}')">
                        <div class="server-option-name">${server.name} ${isRecommended ? '(推荐)' : ''}</div>
                        <div class="server-option-address">${server.ip}:${server.port}</div>
                        ${statusBadge}
                        ${delayInfo}
                        ${isRecommended ? '<div class="recommended-badge">延迟最低</div>' : ''}
                    </div>
                `;
            });
            
            dialogHTML += `
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            const dialogContainer = document.createElement('div');
            dialogContainer.id = 'serverDialogContainer';
            dialogContainer.innerHTML = dialogHTML;
            document.body.appendChild(dialogContainer);
            
            window.closeServerDialog = function() {
                const dialog = document.getElementById('serverDialogContainer');
                if (dialog) {
                    document.body.removeChild(dialog);
                }
            };
            
            window.connectToMinecraft = function(serverName, serverIP, serverPort) {
                const minecraftLink = `minecraft://?addExternalServer=${serverName}|${serverIP}:${serverPort}`;
                const deviceInfo = detectDevice();
                
                const startTime = Date.now();
                window.location.href = minecraftLink;
                
                // 设置一个超时，如果超过一定时间仍在当前页面，可能是应用未安装
                setTimeout(function() {
                    if (Date.now() - startTime < 1500) {
                        if (confirm("看起来您可能没有安装Minecraft或无法自动启动。\n是否需要下载Minecraft 1.20.15？")) {
                            showDownloadOptions();
                        } else {
                            alert(`如果Minecraft没有自动打开，您可以手动添加服务器。\nIP：${serverIP}\n端口：${serverPort}`);                            
                        }
                    }
                    
                    closeServerDialog();
                }, 1000);
            };
        }
        
        function displayOfflineStatus(server) {
            const motdContainer = document.getElementById('motdContainer');
            const serverAddress = server ? `${server.ip}:${server.port}` : "msfxp.ucket.my:19125";
            
            motdContainer.innerHTML = `
                <div class="motd-header">
                    <h2 class="motd-title"><span class="motd-status-indicator motd-offline"></span>服务器离线</h2>
                </div>
                <div class="motd-address">${serverAddress}</div>
                <div class="motd-error">服务器当前无法连接，请稍后再试或切换其他服务器ip</div>
                <div class="server-selectors">
                    <button class="server-selector" onclick="switchServer(0)">主要IP</button>
                    <button class="server-selector" onclick="switchServer(1)">备用IP</button>
                </div>
                <button class="motd-button" onclick="location.reload()">刷新状态</button>
            `;
        }
        
        function connectToServer() {
            const personalCenterUrl = "http://map.msfxp.top";
            window.open(personalCenterUrl, "_blank");
        }
        
        function showDownloadOptions() {
            const downloadLinks = {
                android: [
                    { name: "下载地址1", url: "https://github.akams.cn/https://github.com/yuexps/MSFXP-Web/releases/download/Minecraft/Android.Minecraft_1.20.15.01.APK" },
                    { name: "下载地址2", url: "https://tvv.tw/https://github.com/yuexps/MSFXP-Web/releases/download/Minecraft/Android.Minecraft_1.20.15.01.APK" },
                    { name: "下载地址3", url: "https://ghfast.top/https://github.com/yuexps/MSFXP-Web/releases/download/Minecraft/Android.Minecraft_1.20.15.01.APK" }
                ],
                ios: [
                    { name: "下载地址1", url: "https://github.akams.cn/https://github.com/yuexps/MSFXP-Web/releases/download/Minecraft/iOS.Minecraft_1.20.13.ipa" },
                    { name: "下载地址2", url: "https://tvv.tw/https://github.com/yuexps/MSFXP-Web/releases/download/Minecraft/iOS.Minecraft_1.20.13.ipa" },
                    { name: "下载地址3", url: "https://ghfast.top/https://github.com/yuexps/MSFXP-Web/releases/download/Minecraft/iOS.Minecraft_1.20.13.ipa" }
                ],
                windows: [
                    { name: "下载地址1", url: "https://github.akams.cn/https://github.com/yuexps/MSFXP-Web/releases/download/Minecraft/Windows.MinecraftUWP_1.20.15.Appx" },
                    { name: "下载地址2", url: "https://tvv.tw/https://github.com/yuexps/MSFXP-Web/releases/download/Minecraft/Windows.MinecraftUWP_1.20.15.Appx" },
                    { name: "下载地址3", url: "https://ghfast.top/https://github.com/yuexps/MSFXP-Web/releases/download/Minecraft/Windows.MinecraftUWP_1.20.15.Appx" }
                ]
            };
            
            // 自动检测设备类型
            const deviceInfo = detectDevice();
            let recommendedPlatform = "android"; // 默认推荐
            
            // 根据设备类型设置推荐平台
            if (deviceInfo.ios) {
                recommendedPlatform = "ios";
            } else if (deviceInfo.windows) {
                recommendedPlatform = "windows";
            } else if (deviceInfo.mac) {
                // Mac平台不推荐任何平台
                recommendedPlatform = "none";
            }
            
            const dialogHTML = `
                <div id="downloadDialog" class="download-dialog">
                    <div class="download-dialog-content">
                        <div class="download-dialog-header">
                            <h3>选择下载版本</h3>
                            <span class="close-dialog" onclick="closeDownloadDialog()">&times;</span>
                        </div>
                        <div class="download-dialog-body">
                            <p class="download-intro">请选择适合您设备的Minecraft版本：</p>
                            ${deviceInfo.mac ? '<div class="mac-notice"><i class="fas fa-info-circle"></i><div><span>检测到您正在使用Mac设备，目前暂无Mac版本，您可尝试使用</span> <a href="https://playcover.io" target="_blank" class="tool-link">PlayCover</a> <span>工具安装iOS版本的IPA安装包。</span></div></div>' : ''}
                            <div class="download-options">
                                <div class="download-links-section">
                                    <div class="platform-selector">
                                        <button class="platform-btn ${!deviceInfo.mac && recommendedPlatform === 'android' ? 'active' : ''}" onclick="switchDownloadPlatform('android')">
                                            <i class="fab fa-android"></i> Android
                                        </button>
                                        <button class="platform-btn ${deviceInfo.mac || recommendedPlatform === 'ios' ? 'active' : ''}" onclick="switchDownloadPlatform('ios')">
                                            <i class="fab fa-apple"></i> iOS
                                        </button>
                                        <button class="platform-btn ${!deviceInfo.mac && recommendedPlatform === 'windows' ? 'active' : ''}" onclick="switchDownloadPlatform('windows')">
                                            <i class="fab fa-windows"></i> Windows
                                        </button>
                                    </div>
                                    
                                    <div class="download-platform-info">
                                        <div id="android-info" class="platform-info-card ${!deviceInfo.mac && recommendedPlatform === 'android' ? 'active' : ''}">
                                            ${recommendedPlatform === 'android' ? '<div class="recommended-badge"><i class="fas fa-check-circle"></i> 推荐</div>' : ''}
                                            <div class="platform-details">
                                                <div class="platform-title">
                                                    <div class="platform-icon-large"><i class="fab fa-android"></i></div>
                                                    <div>
                                                        <div class="platform-name">Android版</div>
                                                        <div class="platform-version">Minecraft 1.20.15.01 APK</div>
                                                    </div>
                                                </div>
                                                <div class="platform-desc">
                                                    <p>适用于所有Android设备，安装后可直接运行。请确保您的设备已开启"安装未知来源应用"选项。</p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div id="ios-info" class="platform-info-card ${deviceInfo.mac || recommendedPlatform === 'ios' ? 'active' : ''}">
                                            ${recommendedPlatform === 'ios' ? '<div class="recommended-badge"><i class="fas fa-check-circle"></i> 推荐</div>' : ''}
                                            <div class="platform-details">
                                                <div class="platform-title">
                                                    <div class="platform-icon-large"><i class="fab fa-apple"></i></div>
                                                    <div>
                                                        <div class="platform-name">iOS版</div>
                                                        <div class="platform-version">Minecraft 1.20.13 IPA</div>
                                                    </div>
                                                </div>
                                                <div class="platform-desc">
                                                    <p>适用于iPhone和iPad设备，需使用AltStore或其他工具签名安装。</p>
                                                    ${deviceInfo.mac ? '<div class="mac-install-tip"><i class="fas fa-laptop-code"></i> <strong>Mac用户安装提示：</strong> <p>您可以使用<a href="https://playcover.io" target="_blank" class="tool-link">PlayCover</a>工具在Mac上直接运行iOS应用。</p><div class="steps"><div class="step">1. 下载并安装PlayCover</div><div class="step">2. 将下载的IPA文件拖入PlayCover</div><div class="step">3. 按照提示完成安装</div></div></div>' : ''}
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div id="windows-info" class="platform-info-card ${!deviceInfo.mac && recommendedPlatform === 'windows' ? 'active' : ''}">
                                            ${recommendedPlatform === 'windows' ? '<div class="recommended-badge"><i class="fas fa-check-circle"></i> 推荐</div>' : ''}
                                            <div class="platform-details">
                                                <div class="platform-title">
                                                    <div class="platform-icon-large"><i class="fab fa-windows"></i></div>
                                                    <div>
                                                        <div class="platform-name">Windows版</div>
                                                        <div class="platform-version">Minecraft 1.20.15 UWP应用包</div>
                                                    </div>
                                                </div>
                                                <div class="platform-desc">
                                                    <p>适用于Windows 10/11系统，需要右键点击安装包，选择"安装"选项完成安装。</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="download-links-container">
                                        <div class="section-title">选择下载地址</div>
                                        <div id="android-links" class="download-links ${!deviceInfo.mac && recommendedPlatform === 'android' ? 'active' : ''}">
                                            ${downloadLinks.android.map((link, index) => 
                                                `<a href="${link.url}" target="_blank" class="download-link">
                                                    <span class="link-name">${link.name}</span>
                                                    <span class="download-icon"><i class="fas fa-download"></i></span>
                                                </a>`
                                            ).join('')}
                                        </div>
                                        
                                        <div id="ios-links" class="download-links ${deviceInfo.mac || recommendedPlatform === 'ios' ? 'active' : ''}">
                                            ${downloadLinks.ios.map((link, index) => 
                                                `<a href="${link.url}" target="_blank" class="download-link">
                                                    <span class="link-name">${link.name}</span>
                                                    <span class="download-icon"><i class="fas fa-download"></i></span>
                                                </a>`
                                            ).join('')}
                                        </div>
                                        
                                        <div id="windows-links" class="download-links ${!deviceInfo.mac && recommendedPlatform === 'windows' ? 'active' : ''}">
                                            ${downloadLinks.windows.map((link, index) => 
                                                `<a href="${link.url}" target="_blank" class="download-link">
                                                    <span class="link-name">${link.name}</span>
                                                    <span class="download-icon"><i class="fas fa-download"></i></span>
                                                </a>`
                                            ).join('')}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            const dialogContainer = document.createElement('div');
            dialogContainer.id = 'downloadDialogContainer';
            dialogContainer.innerHTML = dialogHTML;
            document.body.appendChild(dialogContainer);
            
            // 防止背景滚动
            document.body.classList.add('dialog-open');
            
            // 阻止对话框内容的滚动事件冒泡到body
            const dialogBody = document.querySelector('.download-dialog-body');
            const dialogContent = document.querySelector('.download-dialog-content');
            
            if (dialogBody && dialogContent) {
                // 阻止触摸事件在对话框上冒泡
                dialogContent.addEventListener('touchstart', function(e) {
                    e.stopPropagation();
                }, { passive: false });
                
                dialogContent.addEventListener('touchmove', function(e) {
                    e.stopPropagation();
                }, { passive: false });
                
                // 阻止整个对话框的触摸事件冒泡到背景
                document.querySelector('.download-dialog').addEventListener('touchmove', function(e) {
                    if (e.target === this) {
                        e.preventDefault();
                    }
                }, { passive: false });
                
                // 处理对话框内容区域的滚动边界，防止橡皮筋效果
                dialogBody.addEventListener('touchstart', function(e) {
                    const scrollTop = this.scrollTop;
                    const scrollHeight = this.scrollHeight;
                    const height = this.offsetHeight;
                    const startY = e.touches[0].pageY;
                    
                    // 存储初始触摸位置，用于计算滚动方向
                    this.dataset.touchStartY = startY;
                    
                    // 检查是否已经滚动到顶部或底部
                    const isAtTop = scrollTop <= 0;
                    const isAtBottom = scrollTop + height >= scrollHeight;
                    
                    // 存储滚动状态
                    this.dataset.isAtTop = isAtTop;
                    this.dataset.isAtBottom = isAtBottom;
                }, { passive: false });
                
                dialogBody.addEventListener('touchmove', function(e) {
                    const startY = parseInt(this.dataset.touchStartY);
                    const currentY = e.touches[0].pageY;
                    const isScrollingUp = currentY > startY;
                    const isScrollingDown = currentY < startY;
                    
                    // 如果在顶部并且正在向下滚动，或者在底部并且正在向上滚动，则阻止默认行为
                    if ((this.dataset.isAtTop === 'true' && isScrollingUp) || 
                        (this.dataset.isAtBottom === 'true' && isScrollingDown)) {
                        e.preventDefault();
                    }
                }, { passive: false });
            }
            
            window.closeDownloadDialog = function() {
                const dialog = document.getElementById('downloadDialogContainer');
                if (dialog) {
                    document.body.removeChild(dialog);
                    // 恢复背景滚动
                    document.body.classList.remove('dialog-open');
                }
            };
            
            window.switchDownloadPlatform = function(platform) {
                // 更新按钮状态
                document.querySelectorAll('.platform-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`.platform-btn:nth-child(${platform === 'android' ? 1 : platform === 'ios' ? 2 : 3})`).classList.add('active');
                
                // 更新平台信息卡片显示
                document.querySelectorAll('.platform-info-card').forEach(card => {
                    card.classList.remove('active');
                });
                document.getElementById(`${platform}-info`).classList.add('active');
                
                // 更新下载链接显示
                document.querySelectorAll('.download-links').forEach(links => {
                    links.classList.remove('active');
                });
                document.getElementById(`${platform}-links`).classList.add('active');
            };
        }
        
        // 检测用户设备类型
        function detectDevice() {
            const userAgent = navigator.userAgent || navigator.vendor || window.opera;
            
            // 设备信息对象
            const deviceInfo = {
                mobile: false,
                ios: false,
                android: false,
                windows: false,
                mac: false
            };
            
            // 检测移动设备
            if (/android/i.test(userAgent)) {
                deviceInfo.mobile = true;
                deviceInfo.android = true;
            }
            
            // iOS设备检测
            if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
                deviceInfo.mobile = true;
                deviceInfo.ios = true;
            }
            
            // Windows检测
            if (/Windows NT/.test(userAgent)) {
                deviceInfo.windows = true;
            }
            
            // Mac检测
            if (/Macintosh|MacIntel|MacPPC|Mac68K/.test(userAgent)) {
                deviceInfo.mac = true;
            }
            
            return deviceInfo;
        }
        
        // 灯箱效果
        function openLightbox(index) {
            const galleryItems = document.querySelectorAll('.gallery-item');
            const lightbox = document.getElementById('lightbox');
            const lightboxImg = document.getElementById('lightbox-img');
            
            if (index >= 0 && index < galleryItems.length) {
                const img = galleryItems[index].querySelector('img');
                if (img) {
                    lightbox.style.display = 'flex';
                    lightboxImg.src = img.src;
                }
            }
        }
        
        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            lightbox.style.display = 'none';
        }
        
        function changeImage(direction) {
            const galleryItems = document.querySelectorAll('.gallery-item');
            const currentIndex = Array.from(galleryItems).findIndex(item => item.querySelector('img').src === document.getElementById('lightbox-img').src);
            const newIndex = (currentIndex + direction + galleryItems.length) % galleryItems.length;
            openLightbox(newIndex);
        }
        
        // 轮播图功能
        let currentSlide = 0;
        const totalSlides = document.querySelectorAll('.gallery-item').length;
        
        function initGallery() {
            // 生成指示点
            const dotsContainer = document.getElementById('galleryDots');
            for (let i = 0; i < totalSlides; i++) {
                const dot = document.createElement('div');
                dot.className = 'gallery-dot' + (i === 0 ? ' active' : '');
                dot.onclick = function() { goToSlide(i); };
                dotsContainer.appendChild(dot);
            }
            
            // 为每个幻灯片项添加点击事件，打开灯箱
            const slides = document.querySelectorAll('.gallery-item');
            slides.forEach((slide, index) => {
                slide.onclick = function() { openLightbox(index); };
            });
            
            // 设置自动轮播
            setInterval(function() {
                slideGallery(1);
            }, 5000);
        }
        
        function slideGallery(direction) {
            currentSlide = (currentSlide + direction + totalSlides) % totalSlides;
            updateGallery();
        }
        
        function goToSlide(index) {
            currentSlide = index;
            updateGallery();
        }
        
        function updateGallery() {
            // 更新轮播位置
            const slidesContainer = document.getElementById('gallerySlides');
            slidesContainer.style.transform = `translateX(-${currentSlide * 100}%)`;
            
            // 更新指示点
            const dots = document.querySelectorAll('.gallery-dot');
            dots.forEach((dot, index) => {
                dot.className = 'gallery-dot' + (index === currentSlide ? ' active' : '');
            });
        }
    </script>
</body>
</html>
